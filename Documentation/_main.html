<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Two-dimensional systematic survey estimators</title>
  <meta name="description" content="<p>This bookdown describes some estimators for two-dimensional systematic surveys and how to implement them with the systematicsurvey R package.</p>" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Two-dimensional systematic survey estimators" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This bookdown describes some estimators for two-dimensional systematic surveys and how to implement them with the systematicsurvey R package.</p>" />
  <meta name="github-repo" content="<a href="https://github.com/Craig44/systematicsurvey" class="uri">https://github.com/Craig44/systematicsurvey</a>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Two-dimensional systematic survey estimators" />
  
  <meta name="twitter:description" content="<p>This bookdown describes some estimators for two-dimensional systematic surveys and how to implement them with the systematicsurvey R package.</p>" />
  

<meta name="author" content="C.Marsh" />


<meta name="date" content="2022-06-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Two-dimensional systematic survey estimators</h1>
<p class="author"><em>C.Marsh</em></p>
<p class="date"><em>2022-06-27</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction<span></span></a></li>
<li><a href="#two-dimensional-systematic-surveys"><span class="toc-section-number">2</span> Two dimensional systematic surveys<span></span></a></li>
<li><a href="#estimatrs"><span class="toc-section-number">3</span> Estimators<span></span></a><ul>
<li><a href="#simple-random-sample-design-based"><span class="toc-section-number">3.1</span> Simple Random Sample (design-based)<span></span></a></li>
<li><a href="#post-stratification-design-based"><span class="toc-section-number">3.2</span> Post-stratification (design-based)<span></span></a></li>
<li><a href="#correlation-adjustment-hybrid"><span class="toc-section-number">3.3</span> Correlation adjustment (hybrid)<span></span></a></li>
<li><a href="#boxlet-estimator-hybrid"><span class="toc-section-number">3.4</span> Boxlet estimator (hybrid)<span></span></a></li>
<li><a href="#geostatistical-model-based-estimator-model-based"><span class="toc-section-number">3.5</span> Geostatistical model-based estimator (model-based)<span></span></a></li>
</ul></li>
<li><a href="#simulations-with-systematicsurvey"><span class="toc-section-number">4</span> Simulations with systematicsurvey<span></span></a><ul>
<li><a href="#srs-estimator"><span class="toc-section-number">4.1</span> SRS estimator<span></span></a></li>
<li><a href="#correlation-adjusted-estimator"><span class="toc-section-number">4.2</span> Correlation adjusted estimator<span></span></a></li>
<li><a href="#boxlet-estimator"><span class="toc-section-number">4.3</span> Boxlet estimator<span></span></a></li>
<li><a href="#geostatistical-estimator"><span class="toc-section-number">4.4</span> Geostatistical estimator<span></span></a></li>
</ul></li>
<li><a href="#references">References<span></span></a></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Two-dimensional systematic survey estimators</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introduction" class="section level1 hasAnchor">
<h1><span class="header-section-number">1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This Gitbook serves two purposes, firstly to demonstrate how to use the R package  the second is the give some theory and equations for the functions in the package.</p>
</div>
<div id="two-dimensional-systematic-surveys" class="section level1 hasAnchor">
<h1><span class="header-section-number">2</span> Two dimensional systematic surveys<a href="#two-dimensional-systematic-surveys" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Two-dimensional systematic surveys are a commonly applied survey design for estimating the abundance of spatial populations <span class="citation">(Millar and Olsen <a href="#ref-millar1995abundance" role="doc-biblioref">1995</a>; Fewster <a href="#ref-fewster2011variance" role="doc-biblioref">2011</a>)</span>. Systematic surveys enforce a uniform sampling pattern over the entire spatial domain. Unlike random sampling, systematic surveys avoid over and under sampling space.</p>
<p>Systematic surveys can have the advantage over random sampling strategies of being more practical to implement, and in simulation studies, the estimated population density has been shown to provide considerably lower variance than random designs under many conditions e.g., <span class="citation">McGarvey, Burch, and Matthews (<a href="#ref-mcgarvey2016precision" role="doc-biblioref">2016</a>)</span>. However, the most common systematic survey design consists of just a single primary sampling unit (PSU) and consequently there is no applicable design-based estimator of this variance. This has led to the development and application of several approximations based on variations of design-based variance estimators designed for random sample designs <span class="citation">(Wolter <a href="#ref-wolter1984investigation" role="doc-biblioref">1984</a>; D’Orazio <a href="#ref-d2003estimating" role="doc-biblioref">2003</a>)</span>.</p>
<div class="figure">
<img src="Figures/alt_full_random_draw.jpeg" id="fig:sys_survey" style="width:50.0%" alt="" />
<p class="caption">Example of systematic survey. Blue rectangles are sampling units</p>
</div>
<div class="figure">
<img src="Figures/alt_first_random_draw.jpeg" id="fig:single_draw" style="width:50.0%" alt="" />
<p class="caption">The only randomly selected sampling unit from</p>
</div>
<p>Consider a spatial survey region <span class="math inline">\(\mathcal{D} \subset \mathbb{R}^2\)</span> of area <span class="math inline">\(A\)</span>. For simplicity <span class="math inline">\(i\)</span> indexes a sampling unit (quadrat) that is spatially referenced by coordinates in <span class="math inline">\(\mathcal{D}\)</span>. A two-dimensional systematic survey that is based on a single PSU requires the specification of the location of the first sampling unit, from which the location of all other sampling units are deterministically specified. The response variable in this setting is either numbers (abundance) or weight (biomass) in each of the <span class="math inline">\(n\)</span> sampling units denoted by <span class="math inline">\(\boldsymbol{y} = (y_1,y_2,\dots, y_n)^T\)</span>.</p>
<p>The population characteristic of focus is the total population within the survey region, denoted by <span class="math inline">\(N\)</span>, or equivalently the mean density over <span class="math inline">\(\mathcal{D}\)</span>, <span class="math inline">\(d_\mathcal{D}=N/A\)</span>.
If <span class="math inline">\(\alpha\)</span> is the area of each sampling unit then <span class="math inline">\(y_\mathcal{D}=\alpha d_\mathcal{D}\)</span> is the expected mean value.
Then, <span class="math inline">\(N=\kappa y_\mathcal{D}\)</span> where <span class="math inline">\(\kappa=A/\alpha\)</span> is the inverse of the sampling fraction.
Design-based methods applied to systematic surveys all use the sample mean estimator of <span class="math inline">\(y_\mathcal{D}\)</span>, <span class="math inline">\(\bar{y}=\sum\limits_{i = 1}^{n} y_i/n\)</span>, and hence the estimator <span class="math inline">\(\widehat{N}=\kappa \bar{y}\)</span> of <span class="math inline">\(N\)</span>, with variance estimator</p>
<p><span class="math display">\[
\widehat{\rm var} \left(\widehat{N}\right) = \kappa^2 \widehat{\rm var}(\bar{y}) \ .
\]</span></p>
<p>In systematic surveys with multiple PSUs the systematic design-based variance estimator (<span class="math inline">\(\widehat{\rm var}_{sys}(\bar{y})\)</span>) is known  and follows,
<span class="math display">\[\begin{equation*}\label{eq:exact_var}
\widehat{\rm var}_{sys}(\bar{y}) = \frac{1}{B}\sum\limits_{b = 1}^{B} \left(\bar{y}_{b} - \bar{y}\right)^2 
\end{equation*}\]</span>
where, <span class="math inline">\(b=1,\dots,B\)</span> are the PSUs, each assumed to contain the same number of sampling units, and <span class="math inline">\(y_b\)</span> is the sample mean within PSU <span class="math inline">\(b\)</span>.
However, <span class="math inline">\(B\)</span> is typically a relatively small number, so this estimated variance generally has few degrees of freedom.</p>
<p>%,
For the systematic design of interest in this study there is just a single PSU (the position of the first quadrat) and hence no design-based variance estimator exists. For this reason, as shown below, some authors have explored the use of the simple random sampling (SRS) variance estimator, ad-hoc estimators utilizing stratified random survey variance estimators <span class="citation">(Millar and Olsen <a href="#ref-millar1995abundance" role="doc-biblioref">1995</a>; Strand <a href="#ref-strand2017study" role="doc-biblioref">2017</a>)</span> and adjusted SRS variance estimators <span class="citation">(Ambrosio Flores, Iglesias Martı́nez, and Marı́n Ferrer <a href="#ref-ambrosio2003systematic" role="doc-biblioref">2003</a>; Strand <a href="#ref-strand2017study" role="doc-biblioref">2017</a>; Brus and Saby <a href="#ref-brus2016approximating" role="doc-biblioref">2016</a>; McGarvey, Burch, and Matthews <a href="#ref-mcgarvey2016precision" role="doc-biblioref">2016</a>)</span>.</p>
<!--chapter:end:index.Rmd-->
</div>
<div id="estimatrs" class="section level1 hasAnchor">
<h1><span class="header-section-number">3</span> Estimators<a href="#estimatrs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simple-random-sample-design-based" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> Simple Random Sample (design-based)<a href="#simple-random-sample-design-based" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The simplest approach is to treat the data as if all points were collected from a SRS design, and to use the usual SRS variance estimator,</p>
<p><span class="math display">\[\begin{equation}\label{eq:srs_var}
\widehat{\rm var}_{srs}(\bar{y}) = \frac{s^2_y}{n} = \frac{1}{n(n - 1)}\sum\limits_{i=1}^n \left(y_i - \bar{y}\right)^2 \ .
\end{equation}\]</span></p>
<p>Several simulation studies have demonstrated that this estimator tends to over-estimate the true variance, and the over-estimation can be substantial when positive autocorrelation exists <span class="citation">(Fewster <a href="#ref-fewster2011variance" role="doc-biblioref">2011</a>; Dunn and Harrison <a href="#ref-dunn1993two" role="doc-biblioref">1993</a>)</span>.</p>
</div>
<div id="post-stratification-design-based" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> Post-stratification (design-based)<a href="#post-stratification-design-based" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This class of estimators was proposed by <span class="citation">Wolter (<a href="#ref-wolter1984investigation" role="doc-biblioref">1984</a>)</span> and has been extended to systematic spatial surveys e.g., <span class="citation">Dunn and Harrison (<a href="#ref-dunn1993two" role="doc-biblioref">1993</a>)</span> <span class="citation">Fewster (<a href="#ref-fewster2011variance" role="doc-biblioref">2011</a>)</span>, <span class="citation">Millar and Olsen (<a href="#ref-millar1995abundance" role="doc-biblioref">1995</a>)</span>. Each stratum contains a fixed number of neighbouring sampled units from the systematic design, and the stratified random sample variance estimator of <span class="math inline">\(\bar{y}\)</span> is used <span class="citation">(Fewster et al. <a href="#ref-fewster2009estimating" role="doc-biblioref">2009</a>)</span> (this is ad-hoc because stratified designs assume simple random sampling within strata). <span class="citation">(Millar and Olsen <a href="#ref-millar1995abundance" role="doc-biblioref">1995</a>)</span> provided a variation on this approach, by showing that it could be applied using strata that overlapped.</p>
<p>Consider <span class="math inline">\(H\)</span> overlapping strata where <span class="math inline">\(h = (1,2,\dots,H)\)</span> index the strata, and let stratum <span class="math inline">\(h\)</span> contain <span class="math inline">\(n_h\)</span> sampling units<br />
(in this case <span class="math inline">\(n_h = 4\)</span> in Figure~). %Delete or add Figure
Let the set of sampling units in strata <span class="math inline">\(h\)</span> be denoted by the set <span class="math inline">\(S_h\)</span>. Then the post-stratified estimate of variance is</p>
<p><span class="math display">\[\begin{equation}\label{strata_var}
\widehat{\rm var}_{str}(\bar{y}) = \sum\limits_{h = 1}^H w_h^2 \frac{s^2_h}{n_h} \ ,
\end{equation}\]</span></p>
<p>where
<span class="math display">\[
s^2_h = \frac{1}{n_h-1} \sum\limits_{i \in S_h} (y_i - \bar{y_h})^2, \text{ and } w_h = \frac{n_h}{\sum_h n_h} \ . 
\]</span>
This formulation follows from <span class="citation">Millar and Olsen (<a href="#ref-millar1995abundance" role="doc-biblioref">1995</a>)</span> and assumes overlapping strata. However, there are alternative overlapping and non-overlapping post-stratified variance estimators (see <span class="citation">D’Orazio (<a href="#ref-d2003estimating" role="doc-biblioref">2003</a>)</span>). These alternative estimators are due in part to their original application for one dimensional systematically sampled data <span class="citation">(Wolter <a href="#ref-wolter1984investigation" role="doc-biblioref">1984</a>)</span>. As discussed by <span class="citation">D’Orazio (<a href="#ref-d2003estimating" role="doc-biblioref">2003</a>)</span>, extending these one-dimensional estimators to two-dimensions is not straightforward.</p>
<div class="figure">
<img src="Figures/overlapping_strata.jpeg" id="fig:overlapping" style="width:50.0%" alt="" />
<p class="caption">Example of systematic survey. Blue rectangles are sampling units</p>
</div>
</div>
<div id="correlation-adjustment-hybrid" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> Correlation adjustment (hybrid)<a href="#correlation-adjustment-hybrid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Defined in <span class="citation">Wolter (<a href="#ref-wolter1984investigation" role="doc-biblioref">1984</a>)</span> and investigated for spatial systematic samples <span class="citation">(Ambrosio Flores, Iglesias Martı́nez, and Marı́n Ferrer <a href="#ref-ambrosio2003systematic" role="doc-biblioref">2003</a>; Strand <a href="#ref-strand2017study" role="doc-biblioref">2017</a>; Brus and Saby <a href="#ref-brus2016approximating" role="doc-biblioref">2016</a>; McGarvey, Burch, and Matthews <a href="#ref-mcgarvey2016precision" role="doc-biblioref">2016</a>)</span>, this estimator makes an adjustment to <span class="math inline">\(Var_{srs}(\bar{y})\)</span> (Equation~) based on the amount of spatial auto-correlation that exists in the systematic sample.</p>
<p><span class="math display">\[\begin{align}\label{eq:adjust_corr}
\widehat{\rm var}_{adj}(\bar{y}) =&amp;  \widehat{\rm var}_{srs}(\bar{y})  \bigg[1 + \frac{2}{ln({\rho})} + \frac{2}{({\rho}^{-1} - 1)}\bigg]&amp; \text{if }{\rho} &gt; 0\\
=&amp; \widehat{\rm var}_{srs}(\bar{y})&amp; \text{if }{\rho}  \leq 0 \ .\nonumber
\end{align}\]</span>
%,
Here, <span class="math inline">\({\rho}\)</span> is often substituted for by an estimate of global spatial-autocorrelation such as the commonly used Morans I .</p>
</div>
<div id="boxlet-estimator-hybrid" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.4</span> Boxlet estimator (hybrid)<a href="#boxlet-estimator-hybrid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The boxlet method proposed by <span class="citation">Fewster (<a href="#ref-fewster2011variance" role="doc-biblioref">2011</a>)</span>} fits a density surface to the spatial domain <span class="math inline">\(\mathcal{D}\)</span> using a two-dimensional generalised additive model (GAM) <span class="citation">(Wood <a href="#ref-wood2017generalized" role="doc-biblioref">2017</a>)</span>. For any possible location, <span class="math inline">\(b\)</span>, of the first quadrat, this enables calculation of the expected total count within the sampled quadrats, <span class="math inline">\(\eta_b\)</span> and within <span class="math inline">\(\mathcal{D}\)</span>, <span class="math inline">\(\eta_\mathcal{D}\)</span>. This calculation is done using finite approximation over a fine lattice within <span class="math inline">\(\mathcal{D}\)</span> (these lattice points correspond to the centroids of the so-called boxlets). Let <span class="math inline">\(p_b=\eta_b/\eta_\mathcal{D}\)</span> denote the proportion of the expected total count that is expected within the sampled quadrats.</p>
<p>Let <span class="math inline">\(y^+=\sum_{i=1}^n y_i\)</span> be the number of individuals counted in the systematic sample. The boxlet method partitions the variance of <span class="math inline">\(y^+\)</span> using the law of total variance (Equation @ref(eq:totvar)).
The first term (<span class="math inline">\({\rm var}_b(E[y^+|b])\)</span>) is the variance in the expected value of <span class="math inline">\(y^+\)</span> due to the possible starting position, <span class="math inline">\(b\)</span>, of the first quadrat. The second component (<span class="math inline">\(E_b[{\rm var}(y^+|b)]\)</span>) quantifies the expected (over <span class="math inline">\(b\)</span>) magnitude of the variability in <span class="math inline">\(y^+\)</span> for a given <span class="math inline">\(b\)</span>,</p>
<p><span class="math display">\[\begin{equation}
{\rm var}(y^+) = {\rm var}_{b}(E[y^+|b]) + E_{b}[{\rm var}(y^+|b)]  
(\#eq:totvar)
\end{equation}\]</span></p>
<p>Under the assumption that the counts in each quadrat are Poisson distributed, then given <span class="math inline">\(b\)</span> it follows that <span class="math inline">\(y^+\)</span> is binomially distributed according to a <span class="math inline">\({\rm Bin}(N,p_b)\)</span> distribution. This gives
<span class="math display">\[\begin{align}
{\rm var}(y^+) &amp;=  {\rm var}_{b}(N p_b) + E_{b}[Np_b(1 - p_b)] \nonumber \\
&amp;=  E_{b}[N^2 p_b^2] + E_{b}[N p_b]^2 
+ E_{b}[Np_b(1 - p_b)] \label{eq:BoxletVar} 
\end{align}\]</span></p>
<p>The boxlet method estimates <span class="math inline">\({\rm var}(y^+)\)</span> by substituting <span class="math inline">\(N\)</span> with <span class="math inline">\(\widehat{N}\)</span>, and numerically evaluating the <span class="math inline">\(E_b\)</span> and <span class="math inline">\({\rm var}_b\)</span> terms (that is, with respect to variability in <span class="math inline">\(p_b\)</span>) over all boxlet centroids within the scope of placement of the first quadrat. This leads to the boxlet variance estimator <span class="math inline">\(y^+\)</span> and hence for <span class="math inline">\(\bar{y}\)</span>,
<span class="math display">\[\begin{equation}
\widehat{\rm var}_{box}(\bar{y}) =  \frac{\widehat{\rm var}_{box}(y^+)}{n^2}
\end{equation}\]</span></p>
</div>
<div id="geostatistical-model-based-estimator-model-based" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.5</span> Geostatistical model-based estimator (model-based)<a href="#geostatistical-model-based-estimator-model-based" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The geostatistical model-based approach partitions the spatial domain <span class="math inline">\(\mathcal{D}\)</span> into <span class="math inline">\(m &gt;&gt; n\)</span> quadrats, with abundances (at the time of the survey) of <span class="math inline">\(\boldsymbol{y}=\{y_i, i= 1, \dots, m\}\)</span>, and hence <span class="math inline">\(N=\sum_i^m y_i\)</span>. The abundances are assumed to be a realisation from a model,
<span class="math display">\[\begin{equation*}
    \boldsymbol{y} \sim f\left(\boldsymbol{X}, \boldsymbol{\theta}\right) \ ,
\end{equation*}\]</span></p>
<p>with auxiliary covariates denoted by <span class="math inline">\(\boldsymbol{X}\)</span> and model parameters denoted by <span class="math inline">\(\boldsymbol{\theta}\)</span>. This natural incorporation of auxiliary covariates is often viewed as an advantage for the model-based approach <span class="citation">(Johnson, Laake, and Ver Hoef <a href="#ref-johnson2010model" role="doc-biblioref">2010</a>; Chambers and Clark <a href="#ref-chambers2012introduction" role="doc-biblioref">2012</a>; Ståhl et al. <a href="#ref-staahl2016use" role="doc-biblioref">2016</a>; Shelton et al. <a href="#ref-shelton2014spatial" role="doc-biblioref">2014</a>)</span>.</p>
<p>Let <span class="math inline">\(\Omega\)</span> be the index of the set of <span class="math inline">\(n\)</span> sampling units selected by the systematic survey. The estimate of total population can be decomposed as
<span class="math display">\[\begin{equation}
\widehat{N} = \sum\limits_{i \in \Omega} y_i + \sum\limits_{j \notin \Omega} E[y_j| y_i, i \in \Omega] \ .(\#eq:totalestimator)
\end{equation}\]</span>
The <span class="math inline">\(y_i, i \in \Omega\)</span> are known and so inference on un-sampled units <span class="math inline">\(y_j, j \notin \Omega\)</span> is the goal.</p>
<p>Geostatistical models have been used with systematic surveys primarily in the acoustic literature <span class="citation">Walline (<a href="#ref-walline_07" role="doc-biblioref">2007</a>)</span>; <span class="citation">Simmonds and Fryer (<a href="#ref-simmonds1996better" role="doc-biblioref">1996</a>)</span> but also in land cover use <span class="citation">Aune-Lundberg and Strand (<a href="#ref-aune2014comparison" role="doc-biblioref">2014</a>)</span>. These studies used kriging equations for model inference, which differs from the SPDE approach <span class="citation">Lindgren, Rue, and Lindström (<a href="#ref-lindgren2011explicit" role="doc-biblioref">2011</a>)</span> that is used for geostatistical models presented here (see Chatper 7 <span class="citation">Gómez-Rubio (<a href="#ref-gomez2020bayesian" role="doc-biblioref">2020</a>)</span> and <span class="citation">Chang, Guillas, and Fioletov (<a href="#ref-chang2015spatial" role="doc-biblioref">2015</a>)</span> for more detail on the difference between these two approaches). The SPDE approach was chosen for its flexibility in response variable distributions, flexibility in incorporating spatio-temporal GFs, ease of including covariates and availability of convenient software for its implementation, i.e. INLA <span class="citation">Lindgren and Rue (<a href="#ref-rinla_ref" role="doc-biblioref">2015</a>)</span>.</p>
<p>The software chosen to implement the spatial model, and estimator for the total population (Equation~@ref(eq:totalestimator)) and corresponding variance was Template Model Builder (TMB) <span class="citation">(Kristensen et al. <a href="#ref-tmb" role="doc-biblioref">2016</a>)</span>. TMB was chosen for its ease of implementing bespoke models (Equation~@ref(eq:totalestimator) only involves using a subset of fitted values) and computational speed <span class="citation">(Muff, Signer, and Fieberg <a href="#ref-muff2020accounting" role="doc-biblioref">2020</a>)</span> required for the purpose of performing 1 000’s of simulations. TMB also has many inbuilt features that enhance its applicability. This includes automatic calculation of standard errors for functions of parameters using Taylor series expansion, which is commonly known as the generalised delta-method <span class="citation">Millar (<a href="#ref-millar2011maximum" role="doc-biblioref">2011</a>)</span>;<span class="citation">Fournier et al. (<a href="#ref-fournier2012ad" role="doc-biblioref">2012</a>)</span>). TMB also includes the “epsilon” method of bias correction <span class="citation">(Tierney, Kass, and Kadane <a href="#ref-tierney1989fully" role="doc-biblioref">1989</a>; Thorson and Kristensen <a href="#ref-thorson2016implementing" role="doc-biblioref">2016</a>)</span>, which approximates the integral that equates to the expectation of non-linear functions of random-effect variables. <span class="citation">Thorson and Kristensen (<a href="#ref-thorson2016implementing" role="doc-biblioref">2016</a>)</span> showed the “epsilon” method to be superior to other bias correction methods commonly used within fisheries models for estimating abundance. Using these estimators of variance, TMB will automatically report estimates of <span class="math inline">\({SE}\left[\widehat{N}\right]\)</span>.</p>
<p>For spatially variable populations it is often better to estimate and provide standard errors for <span class="math inline">\(\log \widehat{N}\)</span>, which has generally been found to be more quadratic <span class="citation">Bolker et al. (<a href="#ref-bolker2013strategies" role="doc-biblioref">2013</a>)</span>. When <span class="math inline">\(\log \widehat{N}\)</span> is of focus, confidence intervals are</p>
<p><span class="math display">\[\begin{equation}
    CI_{95\%} = exp \left(\log \widehat{N} \pm 1.96 \ \widehat{SE}\left[\log \widehat{N}\right]\right) \ .
\end{equation}\]</span></p>
<p>Considerations when using model-based estimators include; assessing sensitivity to starting values, model convergence, model selection, goodness of fit, etc. As in all regression analysis, these are expected for any valid inferences.</p>
<!--chapter:end:01-estimators.Rmd-->
</div>
</div>
<div id="simulations-with-systematicsurvey" class="section level1 hasAnchor">
<h1><span class="header-section-number">4</span> Simulations with systematicsurvey<a href="#simulations-with-systematicsurvey" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(INLA)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(raster)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(rgeos)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(systematicsurvey)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># can install it using </span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">## devtools::install_github(&quot;Craig44/systematicsurvey&quot;)</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">## Assume a square domain</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>survey_xlim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>survey_ylim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># simualted population size</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>N =<span class="st"> </span><span class="fl">5e5</span> </span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">## spatial distribution</span></span>
<span id="cb1-16"><a href="#cb1-16"></a>beta1 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb1-17"><a href="#cb1-17"></a>beta2 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a>survey_area =<span class="st"> </span><span class="kw">diff</span>(survey_ylim) <span class="op">*</span><span class="st"> </span><span class="kw">diff</span>(survey_xlim) <span class="co"># Area of survey</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">## create a polygon</span></span>
<span id="cb1-21"><a href="#cb1-21"></a>s_poly =<span class="st"> </span><span class="kw">Polygon</span>(<span class="kw">cbind</span>(<span class="dt">x =</span> <span class="kw">c</span>(survey_xlim[<span class="dv">1</span>],survey_xlim[<span class="dv">1</span>],survey_xlim[<span class="dv">2</span>],survey_xlim[<span class="dv">2</span>]), <span class="dt">y =</span> <span class="kw">c</span>(survey_ylim[<span class="dv">1</span>],survey_ylim[<span class="dv">2</span>],survey_ylim[<span class="dv">2</span>],survey_ylim[<span class="dv">1</span>])))</span>
<span id="cb1-22"><a href="#cb1-22"></a>s_polys =<span class="st"> </span><span class="kw">Polygons</span>(<span class="kw">list</span>(s_poly),<span class="dv">1</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>sp_survey_poly =<span class="st"> </span><span class="kw">SpatialPolygons</span>(<span class="kw">list</span>(s_polys)) <span class="co">## add projection coordinater here if you are using</span></span>
<span id="cb1-24"><a href="#cb1-24"></a>survey_area =<span class="st"> </span>rgeos<span class="op">::</span><span class="kw">gArea</span>(sp_survey_poly)</span>
<span id="cb1-25"><a href="#cb1-25"></a>survey_polygon =<span class="st"> </span>sp_survey_poly</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">## sampling unit</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>quad_width =<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>quad_height =<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>quad_x_spacing =<span class="st"> </span><span class="dv">10</span> <span class="co">## spacings between quadrant/transect midpoints</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>quad_y_spacing =<span class="st"> </span><span class="dv">10</span> <span class="co">## spacings between quadrant/transect midpoints</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>sampling_unit_area =<span class="st"> </span>quad_width <span class="op">*</span><span class="st"> </span>quad_height</span>
<span id="cb1-33"><a href="#cb1-33"></a>boxlet_diameter =<span class="st"> </span>quad_width <span class="co">## will define how many boxlets there are, should be less than quadrant size</span></span>
<span id="cb1-34"><a href="#cb1-34"></a>kappa =<span class="st"> </span>survey_area <span class="op">/</span><span class="st"> </span>sampling_unit_area <span class="co">## sampling fraction</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="co">## variables that define the toal number of sampling units</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>n_col =<span class="st"> </span><span class="kw">max</span>(survey_xlim) <span class="op">/</span><span class="st">  </span>quad_x_spacing <span class="co"># r</span></span>
<span id="cb1-37"><a href="#cb1-37"></a>n_row =<span class="st"> </span><span class="kw">max</span>(survey_ylim) <span class="op">/</span><span class="st">  </span>quad_y_spacing <span class="co"># r</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>n_strata =<span class="st"> </span>n_row <span class="op">*</span><span class="st"> </span>n_col</span>
<span id="cb1-39"><a href="#cb1-39"></a>n_l =<span class="st"> </span>quad_y_spacing <span class="op">/</span><span class="st"> </span>quad_height<span class="co"># l</span></span>
<span id="cb1-40"><a href="#cb1-40"></a>n_k =<span class="st"> </span>quad_x_spacing <span class="op">/</span><span class="st"> </span>quad_width <span class="co"># k</span></span>
<span id="cb1-41"><a href="#cb1-41"></a>n_quads =<span class="st"> </span>n_l <span class="op">*</span><span class="st"> </span>n_row <span class="op">*</span><span class="st"> </span>n_col <span class="op">*</span><span class="st"> </span>n_k</span>
<span id="cb1-42"><a href="#cb1-42"></a>within_rows =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n_l, n_k)</span>
<span id="cb1-43"><a href="#cb1-43"></a>within_cols =<span class="st"> </span><span class="kw">sort</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n_k, n_l))</span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="co">## lower and upper limits for discrete non-overlapping quadrats</span></span>
<span id="cb1-45"><a href="#cb1-45"></a>quad_x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(survey_xlim), <span class="dt">by =</span> quad_width)</span>
<span id="cb1-46"><a href="#cb1-46"></a>quad_y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(survey_ylim), <span class="dt">by =</span> quad_height)</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="co"># create a raster layer with all projection spaces</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>proj_raster &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="dt">resolution =</span> quad_width, <span class="dt">xmn =</span> survey_xlim[<span class="dv">1</span>], <span class="dt">xmx =</span> survey_xlim[<span class="dv">2</span>], <span class="dt">ymn =</span> survey_ylim[<span class="dv">1</span>], <span class="dt">ymx =</span> survey_ylim[<span class="dv">2</span>])</span>
<span id="cb1-50"><a href="#cb1-50"></a>proj_poly &lt;-<span class="st"> </span><span class="kw">rasterToPolygons</span>(proj_raster, <span class="dt">dissolve=</span>F)</span>
<span id="cb1-51"><a href="#cb1-51"></a></span>
<span id="cb1-52"><a href="#cb1-52"></a><span class="co">## simulate spatial distribution</span></span>
<span id="cb1-53"><a href="#cb1-53"></a>x_coord =<span class="st"> </span><span class="kw">rbeta</span>(N, beta1[<span class="dv">1</span>], beta1[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(survey_xlim)</span>
<span id="cb1-54"><a href="#cb1-54"></a>y_coord =<span class="st"> </span><span class="kw">rbeta</span>(N, beta2[<span class="dv">1</span>], beta2[<span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="kw">max</span>(survey_ylim)</span>
<span id="cb1-55"><a href="#cb1-55"></a><span class="co">## rasterize</span></span>
<span id="cb1-56"><a href="#cb1-56"></a>pop_raster &lt;-<span class="st"> </span><span class="kw">rasterize</span>(<span class="dt">x =</span> <span class="kw">cbind</span>(x_coord, y_coord), <span class="dt">y =</span> proj_raster,  <span class="dt">field =</span> <span class="dv">1</span>, <span class="dt">fun =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb1-57"><a href="#cb1-57"></a>pop_raster_pts &lt;-<span class="st"> </span><span class="kw">rasterToPoints</span>(pop_raster, <span class="dt">spatial =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-58"><a href="#cb1-58"></a><span class="co"># Then to a &#39;conventional&#39; dataframe</span></span>
<span id="cb1-59"><a href="#cb1-59"></a>pop_df  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pop_raster_pts)</span>
<span id="cb1-60"><a href="#cb1-60"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb1-61"><a href="#cb1-61"></a><span class="st"> </span><span class="kw">geom_tile</span>(<span class="dt">data =</span> pop_df , <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> layer)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-62"><a href="#cb1-62"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Population&quot;</span>) <span class="op">+</span></span>
<span id="cb1-63"><a href="#cb1-63"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Abundance&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Now simulate a two-dimensional systematic survey with a single PSU.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>PSU =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(within_cols), <span class="dt">size =</span> <span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># convert cols and rows to survey units</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>within_x =<span class="st"> </span>within_cols[PSU] <span class="op">*</span><span class="st"> </span>quad_width</span>
<span id="cb2-4"><a href="#cb2-4"></a>within_y =<span class="st"> </span>within_rows[PSU] <span class="op">*</span><span class="st"> </span>quad_height</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>upper_x1 =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> within_x, <span class="dt">to =</span> survey_xlim[<span class="dv">2</span>], <span class="dt">by =</span> quad_x_spacing)</span>
<span id="cb2-7"><a href="#cb2-7"></a>upper_y1 =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> within_y, <span class="dt">to =</span> survey_ylim[<span class="dv">2</span>], <span class="dt">by =</span> quad_y_spacing)</span>
<span id="cb2-8"><a href="#cb2-8"></a>upper_x =<span class="st"> </span><span class="kw">rep</span>(upper_x1, <span class="kw">length</span>(upper_y1))</span>
<span id="cb2-9"><a href="#cb2-9"></a>upper_y =<span class="st"> </span><span class="kw">sort</span>(<span class="kw">rep</span>(upper_y1, <span class="kw">length</span>(upper_x1)))</span>
<span id="cb2-10"><a href="#cb2-10"></a>sample_y_coord =<span class="st"> </span>upper_y <span class="op">-</span><span class="st"> </span>quad_height <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>sample_x_coord =<span class="st"> </span>upper_x <span class="op">-</span><span class="st"> </span>quad_width <span class="op">/</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">## data frame</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>Data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x_mid =</span> sample_x_coord, <span class="dt">y_mid =</span> sample_y_coord)</span>
<span id="cb2-14"><a href="#cb2-14"></a>Data<span class="op">$</span>y_i =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>counter =<span class="st"> </span><span class="dv">1</span>;</span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">## population in sampling units</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(upper_x)) {</span>
<span id="cb2-18"><a href="#cb2-18"></a>  Data<span class="op">$</span>y_i[i] =<span class="st"> </span><span class="kw">sum</span>(x_coord <span class="op">&gt;=</span><span class="st"> </span>(upper_x[i] <span class="op">-</span><span class="st"> </span>quad_width) <span class="op">&amp;</span><span class="st"> </span>x_coord <span class="op">&lt;=</span><span class="st"> </span>upper_x[i] </span>
<span id="cb2-19"><a href="#cb2-19"></a>                      <span class="op">&amp;</span><span class="st"> </span>y_coord <span class="op">&gt;=</span><span class="st"> </span>(upper_y[i]  <span class="op">-</span><span class="st"> </span>quad_height) <span class="op">&amp;</span><span class="st"> </span>y_coord <span class="op">&lt;=</span><span class="st"> </span>upper_y[i])</span>
<span id="cb2-20"><a href="#cb2-20"></a>}</span>
<span id="cb2-21"><a href="#cb2-21"></a>Data<span class="op">$</span>area =<span class="st"> </span>quad_height <span class="op">*</span><span class="st"> </span>quad_height</span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">## convert to densities</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>Data<span class="op">$</span>d_i =<span class="st"> </span>Data<span class="op">$</span>y_i <span class="op">/</span><span class="st"> </span>Data<span class="op">$</span>area</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co">## convert it to spatial data frame</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="kw">coordinates</span>( Data ) &lt;-<span class="st"> </span><span class="er">~</span><span class="st"> </span>x_mid <span class="op">+</span><span class="st"> </span>y_mid</span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co">## can also add projection of data if working lat longs etc</span></span>
<span id="cb2-28"><a href="#cb2-28"></a><span class="co"># proj4string(Data) &lt;- CRS(&quot;+init=epsg:4326&quot;)</span></span>
<span id="cb2-29"><a href="#cb2-29"></a></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">## calculate sample raster</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>sample_raster &lt;-<span class="st"> </span><span class="kw">rasterize</span>(<span class="dt">x =</span> <span class="kw">cbind</span>(sample_x_coord, sample_y_coord), <span class="dt">y =</span> proj_raster,  <span class="dt">field =</span> <span class="dv">1</span>, <span class="dt">fun =</span> <span class="st">&quot;sum&quot;</span>, <span class="dt">na.rm =</span> T)</span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="co">## calculate polygons</span></span>
<span id="cb2-33"><a href="#cb2-33"></a>samp_poly &lt;-<span class="st"> </span><span class="kw">rasterToPolygons</span>(sample_raster, <span class="dt">dissolve=</span><span class="ot">TRUE</span>)</span></code></pre></div>
<div id="srs-estimator" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.1</span> SRS estimator<a href="#srs-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>srs_var_hat  =<span class="st"> </span>kappa<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(Data<span class="op">@</span>data<span class="op">$</span>d_i) <span class="op">/</span><span class="st"> </span>(<span class="kw">nrow</span>(Data<span class="op">@</span>data))</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">## standard error</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">sqrt</span>(srs_var_hat)</span></code></pre></div>
<pre><code>## [1] 397008.6</code></pre>
</div>
<div id="correlation-adjusted-estimator" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.2</span> Correlation adjusted estimator<a href="#correlation-adjusted-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="boxlet-estimator" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.3</span> Boxlet estimator<a href="#boxlet-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first thing we need to do is calculate the fine lattice within <span class="math inline">\(\mathcal{D}\)</span> (these lattice points correspond to the centroids of the so-called boxlets). This is done using the <code>?BoxletEstimatorSamplingFrame</code> function. This function will return a list containing a fine lattice for all the boxlets. The other function that will calculate the boxlet variance is <code>?BoxletEstimator</code>. These are applied in the following code chunk.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## build lattice that we will evaluate the variance over</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">## for large survey areas can take a few seconds to a minute</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>boxlet_frame_single =<span class="st"> </span><span class="kw">BoxletEstimatorSamplingFrame</span>(survey_polygon, <span class="dt">quad_width =</span> quad_width,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                                     <span class="dt">quad_height =</span> quad_height, <span class="dt">quad_x_spacing =</span> quad_x_spacing,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                                     <span class="dt">quad_y_spacing =</span> quad_y_spacing, <span class="dt">boxlet_per_sample_width =</span> <span class="dv">1</span>, </span>
<span id="cb5-6"><a href="#cb5-6"></a>                                     <span class="dt">boxlet_per_sample_height =</span> <span class="dv">1</span>, <span class="dt">trace =</span> F)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">## use the </span></span>
<span id="cb5-9"><a href="#cb5-9"></a>boxlet_estimator_single =<span class="st"> </span><span class="kw">BoxletEstimator</span>(<span class="dt">spatial_df =</span> Data, <span class="dt">survey_polygon =</span> survey_polygon,</span>
<span id="cb5-10"><a href="#cb5-10"></a>                                          <span class="dt">quad_width =</span> quad_width, <span class="dt">quad_height =</span> quad_height, </span>
<span id="cb5-11"><a href="#cb5-11"></a>                                          <span class="dt">quad_x_spacing =</span> quad_x_spacing, <span class="dt">quad_y_spacing =</span> quad_y_spacing, </span>
<span id="cb5-12"><a href="#cb5-12"></a>                                          <span class="dt">boxlet_sampling_frame =</span> boxlet_frame_single)</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw">names</span>(boxlet_estimator_single)</span></code></pre></div>
<pre><code>## [1] &quot;var_total_boxlet&quot; &quot;boxlet_df&quot;        &quot;N_hat&quot;            &quot;gam_N_hat&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## standard error</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">sqrt</span>(boxlet_estimator_single<span class="op">$</span>var_total_boxlet)</span></code></pre></div>
<pre><code>## [1] 84470.52</code></pre>
</div>
<div id="geostatistical-estimator" class="section level2 hasAnchor">
<h2><span class="header-section-number">4.4</span> Geostatistical estimator<a href="#geostatistical-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Build a mesh INLA mesh</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>mesh =<span class="st"> </span><span class="kw">inla.mesh.2d</span>(<span class="dt">max.edge =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">20</span>), <span class="dt">n =</span><span class="dv">15</span>, <span class="dt">cutoff =</span> <span class="dv">6</span>, </span>
<span id="cb9-2"><a href="#cb9-2"></a>      <span class="dt">loc.domain =</span> <span class="kw">SpatialPoints</span>( <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">100</span>),<span class="dt">y=</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">0</span>))))</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## don&#39;t give data points to the inla.mesh.2d function</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## the triangulation mesh calculation will want to put all the vertices </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## at observation locations due to the systematice shape</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="kw">plot</span>(mesh)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">points</span>(Data, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/r_mesh-1.png" width="672" /></p>
<p>Identify which cells to get the model to predict for</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>proj_indicator =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">gContains</span>(samp_poly,proj_poly, <span class="dt">byid =</span> <span class="ot">TRUE</span>), <span class="dv">1</span>, any)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">## visualise</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Domain&quot;</span> =<span class="st"> &quot;gold&quot;</span>, <span class="st">&quot;Samples&quot;</span> =<span class="st"> &quot;blue&quot;</span>, <span class="st">&quot;Projection&quot;</span> =<span class="st"> &quot;black&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a>pop_outline =<span class="st"> </span><span class="kw">fortify</span>(proj_poly)</span></code></pre></div>
<pre><code>## Regions defined for each Polygons</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>sample_outline =<span class="st"> </span><span class="kw">fortify</span>(samp_poly)</span></code></pre></div>
<pre><code>## Regions defined for each Polygons</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>domain_area =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(survey_xlim[<span class="dv">1</span>],survey_xlim[<span class="dv">2</span>], survey_xlim[<span class="dv">2</span>], survey_xlim[<span class="dv">1</span>],survey_xlim[<span class="dv">1</span>]),</span>
<span id="cb14-2"><a href="#cb14-2"></a>                         <span class="dt">y =</span> <span class="kw">c</span>(survey_ylim[<span class="dv">1</span>],survey_ylim[<span class="dv">1</span>],survey_ylim[<span class="dv">2</span>],survey_ylim[<span class="dv">2</span>],survey_ylim[<span class="dv">1</span>]))</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw">coord_fixed</span>() <span class="op">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">col=</span><span class="st">&quot;Domain&quot;</span>), <span class="dt">data =</span> domain_area, </span>
<span id="cb14-7"><a href="#cb14-7"></a>          <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">col=</span><span class="st">&quot;Projection&quot;</span>), <span class="dt">data =</span> pop_outline, </span>
<span id="cb14-9"><a href="#cb14-9"></a>                <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group, <span class="dt">col=</span><span class="st">&quot;Samples&quot;</span>), <span class="dt">data =</span> sample_outline, </span>
<span id="cb14-11"><a href="#cb14-11"></a>            <span class="dt">size=</span><span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">legend.text =</span> <span class="kw">element_text</span>( <span class="dt">size =</span> <span class="dv">16</span>)) <span class="op">+</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> colors[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span></code></pre></div>
<p><img src="_main_files/figure-html/r_proj-1.png" width="672" /></p>
<p>Fit the model</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">## create a projection data frame</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>proj_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">rasterToPoints</span>(proj_raster, <span class="dt">spatial =</span> F))</span>
<span id="cb15-3"><a href="#cb15-3"></a>proj_df<span class="op">$</span>area =<span class="st"> </span>quad_width <span class="op">*</span><span class="st"> </span>quad_height</span>
<span id="cb15-4"><a href="#cb15-4"></a>proj_df<span class="op">$</span>y_i =<span class="st"> </span><span class="dv">0</span> <span class="co">## dummy variable</span></span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>fit_poisson =<span class="st"> </span><span class="kw">tryCatch</span>(</span>
<span id="cb15-7"><a href="#cb15-7"></a>  <span class="dt">expr =</span> <span class="kw">SpatialModelEstimator</span>(<span class="dt">spatial_df =</span> Data, <span class="dt">formula =</span> y_i <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">mesh =</span> mesh, </span>
<span id="cb15-8"><a href="#cb15-8"></a>            <span class="dt">extrapolation_grid =</span> proj_df, <span class="dt">family =</span> <span class="dv">0</span>, <span class="dt">link =</span> <span class="dv">0</span>, <span class="dt">bias_correct =</span> T, </span>
<span id="cb15-9"><a href="#cb15-9"></a>            <span class="dt">convergence =</span> <span class="kw">list</span>(<span class="dt">grad_tol =</span> <span class="fl">0.001</span>)),</span>
<span id="cb15-10"><a href="#cb15-10"></a>  <span class="dt">error =</span> <span class="cf">function</span>(e) {e}</span>
<span id="cb15-11"><a href="#cb15-11"></a>)</span></code></pre></div>
<!--chapter:end:03-Simulation.Rmd-->
</div>
</div>
<div id="references" class="section level1 unnumbered hasAnchor">
<h1>References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:07-references.Rmd-->
<div id="refs" class="references">
<div id="ref-ambrosio2003systematic">
<p>Ambrosio Flores, Luis, Luis Iglesias Martı́nez, and Carmen Marı́n Ferrer. 2003. “Systematic Sample Design for the Estimation of Spatial Means.” <em>Environmetrics: The Official Journal of the International Environmetrics Society</em> 14 (1): 45–61.</p>
</div>
<div id="ref-aune2014comparison">
<p>Aune-Lundberg, Linda, and Geir-Harald Strand. 2014. “Comparison of Variance Estimation Methods for Use with Two-Dimensional Systematic Sampling of Land Use/Land Cover Data.” <em>Environmental Modelling &amp; Software</em> 61: 87–97.</p>
</div>
<div id="ref-bolker2013strategies">
<p>Bolker, Benjamin M, Beth Gardner, Mark Maunder, Casper W Berg, Mollie Brooks, Liza Comita, Elizabeth Crone, et al. 2013. “Strategies for fitting nonlinear ecological models in R, AD Model Builder, and BUGS.” <em>Methods in Ecology and Evolution</em> 4 (6): 501–12.</p>
</div>
<div id="ref-brus2016approximating">
<p>Brus, DJ, and NPA Saby. 2016. “Approximating the Variance of Estimated Means for Systematic Random Sampling, Illustrated with Data of the French Soil Monitoring Network.” <em>Geoderma</em> 279: 77–86.</p>
</div>
<div id="ref-chambers2012introduction">
<p>Chambers, Ray, and Robert Clark. 2012. <em>An Introduction to Model-Based Survey Sampling with Applications</em>. Vol. 37. Oxford University Press.</p>
</div>
<div id="ref-chang2015spatial">
<p>Chang, K-L, S Guillas, and VE Fioletov. 2015. “Spatial Mapping of Ground-Based Observations of Total Ozone.” <em>Atmospheric Measurement Techniques</em> 8 (10): 4487–4505.</p>
</div>
<div id="ref-d2003estimating">
<p>D’Orazio, Marcello. 2003. “Estimating the Variance of the Sample Mean in Two-Dimensional Systematic Sampling.” <em>Journal of Agricultural, Biological, and Environmental Statistics</em> 8 (3): 280.</p>
</div>
<div id="ref-dunn1993two">
<p>Dunn, R, and A R Harrison. 1993. “Two-Dimensional Systematic Sampling of Land Use.” <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em> 42 (4): 585–601.</p>
</div>
<div id="ref-fewster2009estimating">
<p>Fewster, Rachel M, Stephen T Buckland, Kenneth P Burnham, David L Borchers, Peter E Jupp, Jeffrey L Laake, and Len Thomas. 2009. “Estimating the Encounter Rate Variance in Distance Sampling.” <em>Biometrics</em> 65 (1): 225–36.</p>
</div>
<div id="ref-fewster2011variance">
<p>Fewster, R M. 2011. “Variance Estimation for Systematic Designs in Spatial Surveys.” <em>Biometrics</em> 67 (4): 1518–31.</p>
</div>
<div id="ref-fournier2012ad">
<p>Fournier, David A, Hans J Skaug, Johnoel Ancheta, James Ianelli, Arni Magnusson, Mark N Maunder, Anders Nielsen, and John Sibert. 2012. “AD Model Builder: Using Automatic Differentiation for Statistical Inference of Highly Parameterized Complex Nonlinear Models.” <em>Optimization Methods and Software</em> 27 (2): 233–49.</p>
</div>
<div id="ref-gomez2020bayesian">
<p>Gómez-Rubio, Virgilio. 2020. <em>Bayesian Inference with Inla</em>. CRC Press.</p>
</div>
<div id="ref-johnson2010model">
<p>Johnson, Devin S, Jeffrey L Laake, and Jay M Ver Hoef. 2010. “A Model-Based Approach for Making Ecological Inference from Distance Sampling Data.” <em>Biometrics</em> 66 (1): 310–18.</p>
</div>
<div id="ref-tmb">
<p>Kristensen, Kasper, Anders Nielsen, Casper W. Berg, Hans Skaug, and Bradley M. Bell. 2016. “TMB: Automatic Differentiation and Laplace Approximation.” <em>Journal of Statistical Software</em> 70 (5): 1–21. <a href="https://doi.org/10.18637/jss.v070.i05">https://doi.org/10.18637/jss.v070.i05</a>.</p>
</div>
<div id="ref-rinla_ref">
<p>Lindgren, Finn, and Håvard Rue. 2015. “Bayesian Spatial Modelling with R-INLA.” <em>Journal of Statistical Software</em> 63 (19): 1–25. <a href="http://www.jstatsoft.org/v63/i19/">http://www.jstatsoft.org/v63/i19/</a>.</p>
</div>
<div id="ref-lindgren2011explicit">
<p>Lindgren, Finn, Håvard Rue, and Johan Lindström. 2011. “An Explicit Link Between Gaussian Fields and Gaussian Markov Random Fields: The Stochastic Partial Differential Equation Approach.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 73 (4): 423–98.</p>
</div>
<div id="ref-mcgarvey2016precision">
<p>McGarvey, Richard, Paul Burch, and Janet M Matthews. 2016. “Precision of Systematic and Random Sampling in Clustered Populations: Habitat Patches and Aggregating Organisms.” <em>Ecological Applications</em> 26 (1): 233–48.</p>
</div>
<div id="ref-millar2011maximum">
<p>Millar, Russell B. 2011. <em>Maximum likelihood estimation and inference: with examples in R, SAS and ADMB</em>. Vol. 111. John Wiley &amp; Sons.</p>
</div>
<div id="ref-millar1995abundance">
<p>Millar, Russell B, and Danette Olsen. 1995. “Abundance of Large Toheroa (<em>Paphies Ventricosa Gray</em>) at Oreti Beach, 1971–90, Estimated from Two-Dimensional Systematic Samples.” <em>New Zealand Journal of Marine and Freshwater Research</em> 29 (1): 93–99.</p>
</div>
<div id="ref-muff2020accounting">
<p>Muff, Stefanie, Johannes Signer, and John Fieberg. 2020. “Accounting for Individual-Specific Variation in Habitat-Selection Studies: Efficient Estimation of Mixed-Effects Models Using Bayesian or Frequentist Computation.” <em>Journal of Animal Ecology</em> 89 (1): 80–92.</p>
</div>
<div id="ref-shelton2014spatial">
<p>Shelton, Andrew Olaf, James T Thorson, Eric J Ward, and Blake E Feist. 2014. “Spatial Semiparametric Models Improve Estimates of Species Abundance and Distribution.” <em>Canadian Journal of Fisheries and Aquatic Sciences</em> 71 (11): 1655–66.</p>
</div>
<div id="ref-simmonds1996better">
<p>Simmonds, E John, and Robert J Fryer. 1996. “Which Are Better, Random or Systematic Acoustic Surveys? A Simulation Using North Sea Herring as an Example.” <em>ICES Journal of Marine Science</em> 53 (1): 39–50.</p>
</div>
<div id="ref-staahl2016use">
<p>Ståhl, Göran, Svetlana Saarela, Sebastian Schnell, Sören Holm, Johannes Breidenbach, Sean P Healey, Paul L Patterson, et al. 2016. “Use of Models in Large-Area Forest Surveys: Comparing Model-Assisted, Model-Based and Hybrid Estimation.” <em>Forest Ecosystems</em> 3 (1): 1–11.</p>
</div>
<div id="ref-strand2017study">
<p>Strand, Geir-Harald. 2017. “A Study of Variance Estimation Methods for Systematic Spatial Sampling.” <em>Spatial Statistics</em> 21: 226–40.</p>
</div>
<div id="ref-thorson2016implementing">
<p>Thorson, James T, and Kasper Kristensen. 2016. “Implementing a Generic Method for Bias Correction in Statistical Models Using Random Effects, with Spatial and Population Dynamics Examples.” <em>Fisheries Research</em> 175: 66–74.</p>
</div>
<div id="ref-tierney1989fully">
<p>Tierney, Luke, Robert E Kass, and Joseph B Kadane. 1989. “Fully Exponential Laplace Approximations to Expectations and Variances of Nonpositive Functions.” <em>Journal of the American Statistical Association</em> 84 (407): 710–16.</p>
</div>
<div id="ref-walline_07">
<p>Walline, Paul D. 2007. “Geostatistical simulations of eastern Bering Sea walleye pollock spatial distributions, to estimate sampling precision.” <em>ICES Journal of Marine Science</em> 64 (3): 559–69. <a href="https://doi.org/10.1093/icesjms/fsl045">https://doi.org/10.1093/icesjms/fsl045</a>.</p>
</div>
<div id="ref-wolter1984investigation">
<p>Wolter, Kirk M. 1984. “An Investigation of Some Estimators of Variance for Systematic Sampling.” <em>Journal of the American Statistical Association</em> 79 (388): 781–90.</p>
</div>
<div id="ref-wood2017generalized">
<p>Wood, Simon N. 2017. <em>Generalized Additive Models: An Introduction with R</em>. CRC press. <a href="https://doi.org/10.1201/9781315370279">https://doi.org/10.1201/9781315370279</a>.</p>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
